<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Export Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            max-width: 800px; 
            margin: 0 auto; 
        }
        .test-content {
            border: 1px solid #ccc;
            padding: 20px;
            margin: 20px 0;
        }
        button {
            background: #007cba;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #005a87; }
        .status { 
            margin: 20px 0; 
            padding: 10px; 
            border-radius: 4px; 
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <h1>PDF Export Test</h1>
    <div id="status"></div>
    
    <div class="test-content" id="testContent">
        <h2>Sample Invoice</h2>
        <p><strong>Invoice #:</strong> TEST-001</p>
        <p><strong>Date:</strong> August 22, 2025</p>
        <p><strong>Bill To:</strong> Test Client</p>
        
        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
            <thead>
                <tr style="background: #f0f0f0;">
                    <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Description</th>
                    <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">Amount</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="border: 1px solid #ddd; padding: 8px;">Test Service</td>
                    <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">$100.00</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #ddd; padding: 8px;"><strong>Total</strong></td>
                    <td style="border: 1px solid #ddd; padding: 8px; text-align: right;"><strong>$100.00</strong></td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <button onclick="testPDF()">Test PDF Export</button>
    <button onclick="testPrint()">Test Print</button>
    <button onclick="checkLibrary()">Check html2pdf Library</button>
    
    <script>
        function showStatus(message, type = 'success') {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function checkLibrary() {
            if (window.html2pdf) {
                showStatus('✅ html2pdf library is loaded and available', 'success');
            } else {
                showStatus('❌ html2pdf library is not available', 'error');
            }
        }
        
        async function testPDF() {
            showStatus('Testing PDF export...', 'warning');
            
            try {
                if (!window.html2pdf) {
                    throw new Error('html2pdf library not loaded');
                }
                
                const element = document.getElementById('testContent');
                const opt = {
                    margin: 10,
                    filename: 'test-invoice.pdf',
                    image: { type: 'jpeg', quality: 0.95 },
                    html2canvas: { 
                        scale: 1.5,
                        useCORS: true,
                        backgroundColor: '#ffffff'
                    },
                    jsPDF: { 
                        unit: 'mm', 
                        format: 'a4', 
                        orientation: 'portrait' 
                    }
                };
                
                await html2pdf().set(opt).from(element).save();
                showStatus('✅ PDF export successful! Check your downloads folder.', 'success');
                
            } catch (error) {
                console.error('PDF test failed:', error);
                showStatus(`❌ PDF export failed: ${error.message}`, 'error');
            }
        }
        
        function testPrint() {
            showStatus('Opening print dialog...', 'warning');
            try {
                window.print();
                showStatus('✅ Print dialog opened successfully', 'success');
            } catch (error) {
                showStatus(`❌ Print failed: ${error.message}`, 'error');
            }
        }
        
        // Auto-check library on load
        window.addEventListener('load', () => {
            setTimeout(checkLibrary, 100);
        });
    </script>
</body>
</html>
